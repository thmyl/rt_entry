import numpy as np
import matplotlib.pyplot as plt


# search width = 1
naive_width1_x = [62.25, 84.60, 91.75, 94.92, 96.55, 97.52, 98.12, 98.52, 98.82, 99.02, 99.20, 99.32]
naive_width1_y = [2390897.376, 1391186.278, 983052.1804, 755966.4653, 612951.6688, 516376.8932,
    444381.2436, 389808.8377, 324328.8825, 313734.3486, 284897.8499, 261450.212]

naive_rt_width1_x = [68.95, 86.24, 92.36, 95.13, 96.66, 97.57, 98.16, 98.54, 98.83, 99.03, 99.20, 99.32]
naive_rt_width1_y = [2290966.49, 1360052.008, 960245.8229, 745489.7868, 605488.1445, 511263.1267,
    439249.586, 386242.0579, 344574.5022, 311255.9489, 282587.2559, 260115.9076]

pca64_width1_x = [59.63, 82.44, 90.04, 93.43, 95.33, 96.52, 97.31, 97.86, 98.25, 98.52, 98.73, 98.88]
pca64_width1_y = [3314441.02, 2021222.84, 1447119.364, 1127183.495, 919802.4264, 777435.7061,
    671587.1619, 591009.5625, 527509.6271, 476081.6575, 433557.338, 397964.0161]

pca64_rt_width1_x = [66.31, 84.39, 90.86, 93.94, 95.66, 96.76, 97.49, 97.98, 98.35, 98.58, 98.78, 98.93]
pca64_rt_width1_y = [3347650.117, 2005390.49, 1450641.909, 1118928.693, 922041.3997, 775217.8362,
    671505.9865, 591359.0614, 527938.5057, 474966.8711, 432503.5033, 397592.1817]

# search width = 4
naive_width4_x = [76.03, 87.53, 92.38, 94.79, 96.25, 97.13, 97.75, 98.19, 98.52, 98.76, 98.95, 99.09]
naive_width4_y = [1185866.839, 942169.6282, 774347.4187, 659861.2972, 571268.6162, 504579.0549,
    450789.5579, 407953.4607, 371419.9757, 341849.9552, 315569.9035, 293669.3694]

naive_rt_width4_x = [83.65, 90.40, 93.76, 95.56, 96.75, 97.48, 98.01, 98.39, 98.63, 98.85, 99.00, 99.14]
naive_rt_width4_y = [1190096.493, 943405.1265, 773760.2427, 655673.2125, 568805.5652, 502431.7698,
    449883.0304, 406507.37, 370588.6059, 341039.6936, 314054.5701, 292982.7697]

pca64_width4_x = [73.24, 85.51, 90.80, 93.48, 95.14, 96.18, 96.92, 97.49, 97.90, 98.20, 98.46, 98.65]
pca64_width4_y = [1729604.076, 1386508.716, 1145741.793, 977803.8525, 853366.1026, 756349.5545,
    676178.2406, 614284.5735, 560685.8309, 514607.1232, 476054.4606, 443423.5848]

pca64_rt_width4_x = [81.85, 88.87, 92.42, 94.46, 95.79, 96.64, 97.25, 97.72, 98.06, 98.34, 98.55, 98.71]
pca64_rt_width4_y = [1753460.015, 1408581.643, 1161046.428, 990138.2233, 858081.8438, 759999.696,
    676965.5695, 616648.27, 558721.6449, 516857.3009, 477643.8783, 444940.8006]


ggnn_x = [79.44, 87.98, 91.15, 92.87, 94.22, 95.82, 96.91, 97.96, 98.69, 99.08, 99.25]
ggnn_y = [488178.7515, 442391.7467, 417327.4351, 389121.7134, 360246.1201, 308307.975,
    259297.0974, 215695.7482, 166890.2997, 137582.0505, 123453.2847]


ganns_x = [81.22, 90.43, 94.24, 96.17, 97.30, 97.97, 98.41, 98.75, 98.98, 99.16, 99.29]
ganns_y = [871915.5986, 668985.8175, 552577.7753, 463456.4583, 401719.3589,
    353394.3528, 315179.0217, 285168.3919, 259504.3467, 240015.361, 221483.9424]




# 放入列表，便于遍历
all_groups = [
    # (naive_width1_x, naive_width1_y),
    # (naive_rt_width1_x, naive_rt_width1_y),
    # (pca64_width1_x, pca64_width1_y),
    # (pca64_rt_width1_x, pca64_rt_width1_y),
    (naive_width4_x, naive_width4_y),
    (naive_rt_width4_x, naive_rt_width4_y),
    (pca64_width4_x, pca64_width4_y),
    (pca64_rt_width4_x, pca64_rt_width4_y),
    (ggnn_x, ggnn_y),
    (ganns_x, ganns_y),
]

plt.figure(figsize=(8, 6))

for i, (x, y) in enumerate(all_groups):
    x = np.array(x)
    y = np.array(y)
    
    # 过滤掉 <= 0 的 y 值，避免 log10 出错
    mask = y > 0
    x = x[mask]
    y = y[mask]
    
    y_log = np.log10(y)
    plt.plot(x, y_log, marker='o', label=f'Group {i+1}')

plt.xlabel('Recall')
plt.ylabel('log10(QPS)')
plt.title('SIFT1M')
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.show()
plt.savefig("./img/deep10M.png", format="png", bbox_inches="tight")
print("图像已保存到文件：./img/deep10M.png")
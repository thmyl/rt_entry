import numpy as np
import matplotlib.pyplot as plt


# search width = 1
naive_width1_x = [60.50, 83.04, 90.37, 93.77, 95.64, 96.82, 97.58, 98.11, 98.47, 98.75, 98.94, 99.13]
naive_width1_y = [4909083.769, 3265210.165, 2444790.518, 1953705.006, 1619126.417, 1386174.298,
    1195102.946, 1067143.609, 950064.6044, 866866.6239, 790232.7235, 726401.046]

naive_rt_width1_x = [67.56, 84.73, 90.95, 94.05, 95.83, 96.94, 97.67, 98.19, 98.52, 98.79, 98.99, 99.15]
naive_rt_width1_y = [4460442.565, 3077349.171, 2304136.847, 1893426.591, 1567299.856, 1343650.78,
    1178085.258, 1046038.235, 936057.8858, 844987.1139, 776403.5435, 716409.3563]

pca64_width1_x = [58.27, 81.00, 88.99, 92.66, 94.70, 96.06, 96.99, 97.62, 98.08, 98.39, 98.65, 98.85]
pca64_width1_y = [6799437.007, 4817767.928, 3723895.493, 3045289.546, 2558061.603, 2202832.402,
    1930900.785, 1729104.635, 1553205.039, 1414003.156, 1297006.768, 1201401.796]

pca64_rt_width1_x = [65.71, 83.28, 89.95, 93.19, 95.09, 96.31, 97.19, 97.76, 98.17, 98.47, 98.70, 98.89]
pca64_rt_width1_y = [6568015.08, 4761473.962, 3704842.6, 3012547.259, 2521603.841, 2191593.486,
    1928439.468, 1720107.541, 1528178.076, 1400240.561, 1289342.68, 1191876.646]

# search width = 4
naive_width4_x = [76.59, 87.04, 91.60, 94.07, 95.54, 96.57, 97.31, 97.84, 98.21, 98.49, 98.73, 98.92]
naive_width4_y = [2832323.61, 2308850.285, 1984788.58, 1723831.802, 1515711.869, 1349037.934,
    1210949.893, 1105975.697, 1011042.607, 937628.924, 869716.4724, 811958.5252]

naive_rt_width4_x = [83.94, 89.87, 93.10, 94.91, 96.16, 97.02, 97.59, 98.03, 98.38, 98.62, 98.83, 98.99]
naive_rt_width4_y = [2773632.738, 2301903.905, 1948125.319, 1682816.092, 1485760.472, 1327982.449,
    1188604.139, 1092533.191, 997247.5966, 924966.7012, 854116.8432, 799884.8166]

pca64_width4_x = [74.55, 85.48, 90.41, 93.09, 94.75, 95.89, 96.71, 97.28, 97.76, 98.13, 98.40, 98.59]
pca64_width4_y = [4426992.257, 3719490.876, 3178336.459, 2805922.742, 2490622.805, 2237627.041,
    2036100.054, 1872971.338, 1715651.373, 1594064.977, 1483241.595, 1381087.662]

pca64_rt_width4_x = [82.71, 88.89, 92.22, 94.16, 95.47, 96.37, 97.08, 97.57, 97.97, 98.26, 98.51, 98.69]
pca64_rt_width4_y = [4358532.918, 3737898.553, 3179599.688, 2819530.323, 2494387.628, 2253632.856,
    2003787.158, 1862367.33, 1714398.375, 1589845.34, 1480437.499, 1385185.442]


ggnn_x = [77.36, 86.19, 89.62, 91.59, 93.09, 94.18, 94.90, 96.55, 97.47, 98.29, 98.80, 99.18]
ggnn_y = [896193.8647, 813894.8122, 751879.6992, 709219.8582, 641025.641, 595238.0952,
    558659.2179, 487804.878, 434782.6087, 367074.8539, 323684.3042, 291243.7565]


ganns_x = [77.90, 88.34, 92.75, 95.10, 96.45, 97.37, 97.99, 98.37, 98.68, 98.93, 99.11]
ganns_y = [1296344.309, 1121579.183, 979719.8001, 893814.8016, 800704.6201,
    740795.6145, 678241.9967, 624804.7485, 580922.5049, 544158.4589, 512978.3523]




# 放入列表，便于遍历
all_groups = [
    # (naive_width1_x, naive_width1_y),
    # (naive_rt_width1_x, naive_rt_width1_y),
    # (pca64_width1_x, pca64_width1_y),
    # (pca64_rt_width1_x, pca64_rt_width1_y),
    (naive_width4_x, naive_width4_y),
    (naive_rt_width4_x, naive_rt_width4_y),
    (pca64_width4_x, pca64_width4_y),
    (pca64_rt_width4_x, pca64_rt_width4_y),
    (ggnn_x, ggnn_y),
    (ganns_x, ganns_y),
]

plt.figure(figsize=(8, 6))

for i, (x, y) in enumerate(all_groups):
    x = np.array(x)
    y = np.array(y)
    
    # 过滤掉 <= 0 的 y 值，避免 log10 出错
    mask = y > 0
    x = x[mask]
    y = y[mask]
    
    y_log = np.log10(y)
    plt.plot(x, y_log, marker='o', label=f'Group {i+1}')

plt.xlabel('Recall')
plt.ylabel('log10(QPS)')
plt.title('SIFT1M')
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.show()
plt.savefig("./img/deep1M.png", format="png", bbox_inches="tight")
print("图像已保存到文件：./img/deep1M.png")